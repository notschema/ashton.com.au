/* ==========================================================================
   Premium Typography System
   
   Optimized for maximum readability:
   - Text balancing for headings, text-pretty for paragraphs
   - Generous spacing with breathing room
   - Clear visual hierarchy
   - Muted body text (80% opacity) for eye comfort
   - Clean, minimal aesthetics
   ========================================================================== */

/* ==========================================================================
   Base text treatments
   ========================================================================== */

h1, h2, h3, h4, h5, h6 {
    text-wrap: balance;
    overflow-wrap: break-word;
}

p {
    text-wrap: pretty;
    overflow-wrap: break-word;
}

/* ==========================================================================
   Prose Container
   ========================================================================== */

.prose {
    color: var(--foreground);
    font-size: 1rem;
    line-height: 1.75;
}

/* Paragraphs - slightly muted for eye comfort */
.prose :where(p):not(:where(.not-prose, .not-prose *)) {
    color: hsl(var(--foreground) / 0.8);
    margin-top: 1.25rem;
    margin-bottom: 1.25rem;
}

/* ==========================================================================
   Headings - Clear hierarchy with scroll margin for anchor links
   ========================================================================== */

.prose :where(h1, h2, h3, h4, h5, h6):not(:where(.not-prose, .not-prose *)) {
    color: var(--foreground);
    font-weight: 500;
    scroll-margin-top: 5rem;
}

/* Remove top margin on first child */
.prose :first-child:not(:where(.not-prose, .not-prose *)) {
    margin-top: 0;
}

/* H1 - Page title (rarely used in content) */
.prose :where(h1):not(:where(.not-prose, .not-prose *)) {
    font-size: 2.25rem;
    line-height: 1.2;
    margin-top: 2rem;
    margin-bottom: 1.5rem;
    letter-spacing: -0.025em;
}

/* H2 - Major sections */
.prose :where(h2):not(:where(.not-prose, .not-prose *)) {
    font-size: 1.5rem;
    line-height: 1.3;
    margin-top: 2rem;
    margin-bottom: 1rem;
    letter-spacing: -0.02em;
}

/* H3 - Subsections */
.prose :where(h3):not(:where(.not-prose, .not-prose *)) {
    font-size: 1.25rem;
    line-height: 1.4;
    margin-top: 2rem;
    margin-bottom: 1rem;
    letter-spacing: -0.01em;
}

/* H4 - Minor headings */
.prose :where(h4):not(:where(.not-prose, .not-prose *)) {
    font-size: 1.125rem;
    line-height: 1.4;
    margin-top: 1.75rem;
    margin-bottom: 0.75rem;
}

/* H5, H6 - Small headings */
.prose :where(h5, h6):not(:where(.not-prose, .not-prose *)) {
    font-size: 1rem;
    line-height: 1.5;
    margin-top: 1.25rem;
    margin-bottom: 0.75rem;
}

/* ==========================================================================
   Links - Underlined with subtle decoration
   ========================================================================== */

.prose :where(a):not(:where(.not-prose, .not-prose *)) {
    color: var(--foreground);
    font-weight: 500;
    text-decoration: underline;
    text-decoration-color: hsl(var(--muted-foreground) / 0.5);
    text-underline-offset: 3px;
    text-decoration-thickness: 1px;
    transition: text-decoration-color 0.2s;
    overflow-wrap: break-word;
}

.prose :where(a):not(:where(.not-prose, .not-prose *)):hover {
    text-decoration-color: var(--foreground);
}

/* ==========================================================================
   Strong emphasis
   ========================================================================== */

.prose :where(strong):not(:where(.not-prose, .not-prose *)) {
    color: var(--foreground);
    font-weight: 600;
}

/* ==========================================================================
   Lists - Clean markers with proper nesting
   ========================================================================== */

.prose :where(ul):not(:where(.not-prose, .not-prose *)) {
    list-style-type: disc;
    padding-left: 1.5rem;
    margin-top: 1.25rem;
    margin-bottom: 1.25rem;
}

.prose :where(ul):not(:where(.not-prose, .not-prose *)) > li {
    margin-top: 0.5rem;
}

.prose :where(ol):not(:where(.not-prose, .not-prose *)) {
    list-style-type: decimal;
    padding-left: 1.5rem;
    margin-top: 1.25rem;
    margin-bottom: 1.25rem;
}

.prose :where(ol):not(:where(.not-prose, .not-prose *)) > li {
    margin-top: 0.5rem;
}

.prose :where(li):not(:where(.not-prose, .not-prose *)) {
    color: hsl(var(--foreground) / 0.8);
    padding-left: 0.5rem;
}

.prose :where(li):not(:where(.not-prose, .not-prose *)) > p {
    margin-top: 0;
    margin-bottom: 0;
}

/* Nested lists */
.prose :where(ul ul, ol ol, ul ol, ol ul):not(:where(.not-prose, .not-prose *)) {
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    padding-left: 1.5rem;
}

/* List markers slightly muted */
.prose ::marker {
    color: hsl(var(--foreground) / 0.3);
}

/* ==========================================================================
   Code - Inline and blocks
   ========================================================================== */

.prose :where(code):not(:where(.not-prose, .not-prose *)) {
    color: var(--foreground);
    font-size: 0.875em;
    font-weight: 500;
    background: hsl(var(--muted) / 0.5);
    padding: 0.2em 0.4em;
    border-radius: 0.25rem;
    font-family: var(--font-mono, ui-monospace, monospace);
    overflow-wrap: break-word;
}

/* Code blocks */
.prose :where(pre):not(:where(.not-prose, .not-prose *)) {
    max-height: min(68vh, 1000px);
    overflow-y: auto;
    overflow-x: auto;
}

.prose :where(pre):not(:where(.not-prose, .not-prose *)) code {
    background: transparent;
    padding: 0;
    font-size: 0.875rem;
    font-weight: 400;
    border-radius: 0;
}

/* ==========================================================================
   Blockquotes - Elegant left border
   ========================================================================== */

.prose :where(blockquote):not(:where(.not-prose, .not-prose *)) {
    color: var(--muted-foreground);
    border-left: 2px solid var(--border);
    padding-left: 1.5rem;
    margin-top: 1.5rem;
    margin-bottom: 1.5rem;
    font-style: normal;
}

.prose :where(blockquote):not(:where(.not-prose, .not-prose *)) * {
    color: var(--muted-foreground);
}

/* ==========================================================================
   Horizontal rules
   ========================================================================== */

.prose :where(hr):not(:where(.not-prose, .not-prose *)) {
    border: none;
    border-top: 1px solid var(--border);
    margin-top: 2rem;
    margin-bottom: 2rem;
}

/* ==========================================================================
   Tables - Clean and minimal
   ========================================================================== */

.prose :where(table):not(:where(.not-prose, .not-prose *)) {
    display: block;
    width: max-content;
    max-width: 100%;
    overflow-x: auto;
    margin: 1.5rem auto;
    font-size: 0.875rem;
}

.prose :where(thead):not(:where(.not-prose, .not-prose *)) {
    border-bottom: 1px solid hsl(var(--muted-foreground) / 0.3);
}

.prose :where(th):not(:where(.not-prose, .not-prose *)) {
    padding: 0.5rem 1rem;
    font-weight: 500;
    text-align: left;
}

.prose :where(th[align="center"]):not(:where(.not-prose, .not-prose *)) {
    text-align: center;
}

.prose :where(th[align="right"]):not(:where(.not-prose, .not-prose *)) {
    text-align: right;
}

.prose :where(tr):not(:where(.not-prose, .not-prose *)) {
    border-bottom: 1px solid hsl(var(--muted-foreground) / 0.3);
}

.prose :where(tr:last-child):not(:where(.not-prose, .not-prose *)) {
    border-bottom: none;
}

.prose :where(td):not(:where(.not-prose, .not-prose *)) {
    color: hsl(var(--foreground) / 0.8);
    padding: 0.5rem 1rem;
    vertical-align: top;
    text-align: left;
    overflow-wrap: break-word;
}

.prose :where(td[align="center"]):not(:where(.not-prose, .not-prose *)) {
    text-align: center;
}

.prose :where(td[align="right"]):not(:where(.not-prose, .not-prose *)) {
    text-align: right;
}

/* ==========================================================================
   Images, videos, figures
   ========================================================================== */

.prose :where(img, video, figure):not(:where(.not-prose, .not-prose *)) {
    margin: 1.5rem auto;
}

.prose :where(figcaption):not(:where(.not-prose, .not-prose *)) {
    color: var(--muted-foreground);
    font-size: 0.875rem;
    text-align: center;
    margin-top: 0.5rem;
}

/* ==========================================================================
   Keyboard shortcuts
   ========================================================================== */

.prose :where(kbd):not(:where(.not-prose, .not-prose *)) {
    color: var(--foreground);
    background: var(--muted);
    border: 1px solid var(--border);
    border-radius: 0.375rem;
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    font-weight: 500;
}

/* ==========================================================================
   Summary/Details (collapsible content)
   ========================================================================== */

.prose :where(summary):not(:where(.not-prose, .not-prose *)) {
    cursor: pointer;
    font-weight: 500;
}

.prose :where(details):not(:where(.not-prose, .not-prose *)) {
    margin-top: 1rem;
    margin-bottom: 1rem;
}

/* ==========================================================================
   Responsive adjustments
   ========================================================================== */

@media (max-width: 640px) {
    .prose {
        font-size: 0.9375rem;
    }

    .prose :where(h1):not(:where(.not-prose, .not-prose *)) {
        font-size: 1.875rem;
    }

    .prose :where(h2):not(:where(.not-prose, .not-prose *)) {
        font-size: 1.375rem;
    }

    .prose :where(h3):not(:where(.not-prose, .not-prose *)) {
        font-size: 1.125rem;
    }

    .prose :where(table):not(:where(.not-prose, .not-prose *)) {
        font-size: 0.8125rem;
    }
}
